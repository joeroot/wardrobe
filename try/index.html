<!DOCTYPE HTML>

<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta name="author" content="Joe Root" />
    <title>Wardrobe</title>

    <link rel="stylesheet" type="text/css" href="css/reset.css">
    <link rel="stylesheet" type="text/css" href="css/ingrid.css">
    <link rel="stylesheet" type="text/css" href="css/blueprint.css">
    <link rel="stylesheet" type="text/css" href="css/dropkick.css">
    <link rel="stylesheet" type="text/css" href="css/tooltip.css">
    <link rel="stylesheet" type="text/css" href="css/typography.css">
    <link rel="stylesheet" type="text/css" href="css/layout.css">
    <link rel="stylesheet" type="text/css" href="css/editor.css">
    <link href="//get.pictos.cc/fonts/2474/1" rel="stylesheet" type="text/css">

    <script type="text/javascript" src="../lib/wardrobe.js"></script>
    <script type="text/javascript" src="scripts/jquery.min.js"></script>
    <script type="text/javascript" src="scripts/jquery.dropkick.js"></script>
    <script type="text/javascript" src="scripts/jquery.bootstrap.tooltip.js"></script>

    <script type="text/javascript" src="http://use.typekit.com/htb2rpi.js"></script>
    <script type="text/javascript">try{Typekit.load();}catch(e){}</script>

    <script src="scripts/ace.js" type="text/javascript" charset="utf-8"></script>
    <script src="scripts/theme-github.js" type="text/javascript" charset="utf-8"></script>
    <script src="scripts/mode-ruby.js" type="text/javascript" charset="utf-8"></script>
    <script>
      (function($) {
        $.fn.blinky = function() {
          var that = this;
          function go() {
            $(that).toggle();
            setTimeout(go, 800); 
          };
          go();
        };
      })(jQuery);

      $(document).ready(function(){
        $('select#files').dropkick({
          change: function() {
            var file = $(this).val();
            $.get('../' + file, function(data){
              editor.setValue(data);
              editor.clearSelection();
              editor.moveCursorTo(0,0);
            });
          }
        });
        $('.flash').blinky();

        $('#run').click(function(){
          var context = Wardrobe.run(editor.getValue());
          var value = context.getReturnObject().toString();
          $('#console pre em.flash').before('\<em class="result"\>\<\/em\>\n');
          $('#console  em.result:last').text('=> ' + value);
          $('#console').scrollTop($('#console').children().height());
          return false;       
        });

        $('.icon').tooltip({placement: 'bottom'});

        var editor = ace.edit("editor");
        editor.setTheme("ace/theme/tomorrow");
        var RubyMode = require("ace/mode/ruby").Mode;
        editor.getSession().setMode(new RubyMode());
        editor.setShowPrintMargin(false);

        $.get('../' + $('select#files').val(), function(data){
          editor.setValue(data);
          editor.clearSelection();
          editor.moveCursorTo(0,0);
        });

        editor.focus();
      });

      function print(value) {
        value = value.toString();
        $('#console pre em.flash').before("\<em class='print'\>\<\/em\>\n");
        $('#console  em.print:last').text(value);
        $('#console').scrollTop($('#console').children().height());
      }

    </script>

  </head>

  <body>

    <div id="error_container"><div id="error">
        <pre>Uh-oh, looks like there might be an error in the code! </pre>
    </div></div>

    <header>
      <div class="ingrid in-thirds">
        <div class="unit">
          <select id="files" name='pretty' class="files">
            <option value='example/simple.wardrobe'>simple.wardrobe</option>
            <option value='example/factorial.wardrobe'>factorial.wardrobe</option>
            <option value='example/fibonacci.wardrobe'>fibonacci.wardrobe</option>
            <option value='example/lists.wardrobe'>lists.wardrobe</option>
            <option value='example/boolean.wardrobe'>boolean.wardrobe</option>
          </select>
          <a href="#" id="run" class='icon' title='Run'><img alt='Run' src='images/icns/201-play.png' /></a>
          <a href="#" id="store" class='icon' title='Stash'><img alt='Stash' src='images/icns/180-stickynote.png' /></a>
        </div>
        <div class="unit title">
          <h3>Wardrobe</h3>
        </div>
        <div class="unit">

        </div>
      </div>
    </header>

    <section>
      <div id="editor_container" class="container"><div id="editor"></div></div>
      <div id="console_container" class="container"><div id="console">
          <pre>Welcome to Wadrobe (über-alpha)!
<em class="flash">▌</em> </pre>
      </div></div>

    </section>
  </body>

</html>
